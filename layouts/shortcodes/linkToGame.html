{{- $game := .Get "game" }}{{- $entry := index (where $.Site.Data.glossary "game" "eq" $game) 0 }}{{- $tag := "cite" }}{{- if .Get "title" }}{{- $tag = "span" }}{{- end }}{{- $title := default $entry.title (.Get "title") }}{{- $scratchKey := printf "abbr-%s" $entry.key }}{{- if ($.Page.Scratch.Get $scratchKey) }}{{- with .Get "abbr" }}<abbr title="{{- $title}}">{{ $entry.abbr }}</abbr>{{- else }}{{ printf "<%s>%s</%s>" $tag $title $tag | safeHTML }}{{- end }}{{- else }}<span itemprop="mentions" itemscope itemtype="http://schema.org/CreativeWork">{{- with $entry.itemid }}<link itemprop="sameAs" href="{{ . }}" />{{- end }}{{ printf "<%s itemprop=\"name\">" $tag | safeHTML }}{{- with $entry.offer }}<a class="u-url p-name" itemprop="offers" href="{{- . }}">{{- $title }}</a>{{- else }}{{- $title }}{{- end }}{{ printf "</%s>" $tag | safeHTML }}{{- if $entry.abbr }} (<abbr title="{{ $title }}">{{ $entry.abbr }}</abbr> <a class="book" rel="tag opener" aria-label="Other site-wide references of “{{ $title }}”" title="Other site-wide references of “{{ $title }}”" href="/site-map/glossary/#abbr-dfn-{{ $entry.key }}">&#128214;</a>){{- end }}</span>{{- $.Page.Scratch.Set $scratchKey "t" }}{{- end }}{{- with .Get "post" }}<small> {{ . }}</small>{{- end }}